// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Gallery {
  id              Int                   @id @default(autoincrement())
  uid             String                @unique @default(cuid())
  createdAt       DateTime              @default(now())
  updatedAt       DateTime              @updatedAt
  name            String
  slug            String                @unique
  address         PostalAddress?        @relation(fields: [postalAddressId], references: [id])
  openingHours    OpeningHours?         @relation(fields: [openingHoursId], references: [id])
  nearestTubes    GalleryTubeStations[]
  googleMap       String?
  postalAddressId Int?
  website         String?

  openingHoursId Int?
}

model TubeStation {
  id        Int                   @id @default(autoincrement())
  uid       String                @unique @default(cuid())
  createdAt DateTime              @default(now())
  updatedAt DateTime              @updatedAt
  name      String                @unique
  galleries GalleryTubeStations[]
}

model GalleryTubeStations {
  gallery       Gallery     @relation(fields: [galleryId], references: [id])
  galleryId     Int
  tubeStation   TubeStation @relation(fields: [tubeStationId], references: [id])
  tubeStationId Int
  assignedAt    DateTime    @default(now())
  assignedBy    String?

  @@id([galleryId, tubeStationId])
}

model PostalAddress {
  id            Int       @id @default(autoincrement())
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  streetAddress String
  locality      String
  city          String
  postalCode    String
  country       String
  Gallery       Gallery[]
}

model OpeningHours {
  id                 Int                 @id @default(autoincrement())
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  openingHoursRanges OpeningHoursRange[]
  Gallery            Gallery[]
}

model OpeningHoursRange {
  id             Int          @id @default(autoincrement())
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  startDay       Int
  endDay         Int
  openingTime    String
  closingTime    String
  OpeningHours   OpeningHours @relation(fields: [openingHoursId], references: [id])
  openingHoursId Int
}
